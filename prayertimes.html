<!DOCTYPE html> 
<html>
<head>
	<meta charset="UTF-8">
	<title>Islamic Prayer Time Widget</title>
	<style>
		body {
			font-family: 'Roboto Mono', monospace;
			text-align: left;
		}
		th, td {
			padding: 10px;
		}
		.current-prayer {
			color: pink;
		}
	</style>
	<script>
	window.onload = function() {
			displayPrayerTimes();
			setInterval(displayPrayerTimes, 1000);
		};
		
		function displayPrayerTimes() {
			var xhr = new XMLHttpRequest();
			var method = 'GET';
			var url = 'https://api.aladhan.com/v1/timingsByCity?city=Essex&state=Maryland&country=USA&method=8';
			var async = true;

			xhr.open(method, url, async);
			xhr.onreadystatechange = function() {
				if(xhr.readyState === 4 && xhr.status === 200) {
					var data = JSON.parse(xhr.responseText);
					document.getElementById('imsak_today').innerHTML = data.data.timings.Imsak;
					document.getElementById('fajr_today').innerHTML = data.data.timings.Fajr;
					document.getElementById('dhuhr_today').innerHTML = data.data.timings.Dhuhr;
					document.getElementById('asr_today').innerHTML = data.data.timings.Asr;
					document.getElementById('maghrib_today').innerHTML = data.data.timings.Maghrib;
					document.getElementById('isha_today').innerHTML = data.data.timings.Isha;

					var now = new Date();
					var currentPrayer;
					if(now > new Date(data.data.timings.Fajr) && now < new Date(data.data.timings.Dhuhr)) {
						currentPrayer = "fajr_today";
					} else if(now > new Date(data.data.timings.Dhuhr) && now < new Date(data.data.timings.Asr)) {
						currentPrayer = "dhuhr_today";
					} else if(now > new Date(data.data.timings.Asr) && now < new Date(data.data.timings.Maghrib)) {
						currentPrayer = "asr_today";
					} else if(now > new Date(data.data.timings.Maghrib) && now < new Date(data.data.timings.Isha)) {
						currentPrayer = "maghrib_today";
					} else {
						currentPrayer = "isha_today";
					}

					// Reset all prayer times to default color
					document.getElementById('imsak_today').classList.remove("current-prayer");
					document.getElementById('fajr_today').classList.remove("current-prayer");
					document.getElementById('dhuhr_today').classList.remove("current-prayer");
					document.getElementById('asr_today').classList.remove("current-prayer");
					document.getElementById('maghrib_today').classList.remove("current-prayer");
					document.getElementById('isha_today').classList.remove("current-prayer");

					// Set the color of the current prayer time to pink
					document.getElementById(currentPrayer).classList.add("current-prayer");
				}

			};
			xhr.send();
		}
	</script>
</head>
<body>
	<table>
		<tr>
			<th></th>
			<th>Prayer</th>
			<th>Time</th>
		</tr>
		<tr>
			<td><img src="https://github.com/brightscorpio/notionwidgets/blob/main/pw_icons/fasting.png?raw=true" width="30"></td>
			<td>Imsak</td>
			<td id="imsak_today"></td>
		</tr>
		<tr>
			<td><img src="https://github.com/brightscorpio/notionwidgets/blob/main/pw_icons/praying.png?raw=true" width="30"></td>
			<td>Fajr</td>
			<td id="fajr_today"></td>
		</tr>
		<tr>
			<td><img src="https://github.com/brightscorpio/notionwidgets/blob/main/pw_icons/praying.png?raw=true" width="30"></td>
			<td>Dhuhr</td>
			<td id="dhuhr_today"></td>
		</tr>
		<tr>
			<td><img src="https://github.com/brightscorpio/notionwidgets/blob/main/pw_icons/praying.png?raw=true" width="30"></td>
			<td>Asr</td>
			<td id="asr_today"></td>
		</tr>
		<tr>
			<td><img src="https://github.com/brightscorpio/notionwidgets/blob/main/pw_icons/praying.png?raw=true" width="30"></td>
			<td>Maghrib</td>
			<td id="maghrib_today"></td>
		</tr>
		<tr>
			<td><img src="https://github.com/brightscorpio/notionwidgets/blob/main/pw_icons/praying.png?raw=true" width="30"></td>
			<td>Isha</td>
			<td id="isha_today"></td>
		</tr>
	</table>
</body>
</html>
